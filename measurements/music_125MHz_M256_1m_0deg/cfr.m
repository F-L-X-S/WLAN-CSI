% Auto-generated MATLAB script
clear;

CH0_1227 = [ ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, -0.615432 + 1i*-0.878019, -0.637646 + 1i*-0.89636, -0.659966 + 1i*-0.913989, -0.682388 + 1i*-0.930909,  ...
-0.704912 + 1i*-0.947124, -0.727532 + 1i*-0.962638, -0.750247 + 1i*-0.977454, -0.77305 + 1i*-0.991576, -0.795941 + 1i*-1.00501,  ...
-0.818911 + 1i*-1.01776, -0.841959 + 1i*-1.02982, -0.865078 + 1i*-1.04121, -0.888263 + 1i*-1.05192, -0.91151 + 1i*-1.06196,  ...
-0.934812 + 1i*-1.07134, -0.958164 + 1i*-1.08005, -0.981561 + 1i*-1.08811, -1.00499 + 1i*-1.09552, -1.02846 + 1i*-1.10228,  ...
-1.05195 + 1i*-1.1084, -1.07546 + 1i*-1.11388, -1.09898 + 1i*-1.11872, -1.12251 + 1i*-1.12294, -1.14603 + 1i*-1.12653,  ...
-1.16955 + 1i*-1.12951, -1.19305 + 1i*-1.13187, -1.21652 + 1i*-1.13363, -1.23997 + 1i*-1.13478, -1.26338 + 1i*-1.13533,  ...
-1.28675 + 1i*-1.13529, -1.31007 + 1i*-1.13467, -1.33332 + 1i*-1.13346, -1.35651 + 1i*-1.13168, -1.37963 + 1i*-1.12933,  ...
-1.40266 + 1i*-1.12642, -1.42561 + 1i*-1.12295, -1.44846 + 1i*-1.11892, -1.47121 + 1i*-1.11436, -1.49385 + 1i*-1.10925,  ...
-1.51637 + 1i*-1.10361, -1.53877 + 1i*-1.09744, -1.56103 + 1i*-1.09076, -1.58315 + 1i*-1.08356, -1.60513 + 1i*-1.07585,  ...
-1.62696 + 1i*-1.06764, -1.64862 + 1i*-1.05894, -1.67012 + 1i*-1.04975, -1.69144 + 1i*-1.04008, -1.71258 + 1i*-1.02994,  ...
-1.73353 + 1i*-1.01933, -1.75429 + 1i*-1.00826, -1.77485 + 1i*-0.996736, -1.79519 + 1i*-0.984768, -1.81532 + 1i*-0.972362,  ...
-1.83523 + 1i*-0.959526, -1.85492 + 1i*-0.946265, -1.87436 + 1i*-0.932588, -1.89357 + 1i*-0.918502, -1.91253 + 1i*-0.904013,  ...
-1.93124 + 1i*-0.889131, -1.94969 + 1i*-0.873864, -1.96787 + 1i*-0.858216, -1.98579 + 1i*-0.842197, -2.00343 + 1i*-0.825814,  ...
-2.02078 + 1i*-0.809075, -2.03785 + 1i*-0.791987, -2.05462 + 1i*-0.77456, -2.0711 + 1i*-0.756799, -2.08727 + 1i*-0.738714,  ...
-2.10313 + 1i*-0.720312, -2.11868 + 1i*-0.701601, -2.13391 + 1i*-0.682589, -2.14881 + 1i*-0.663284, -2.16339 + 1i*-0.643694,  ...
-2.17763 + 1i*-0.623827, -2.19153 + 1i*-0.603692, -2.20509 + 1i*-0.583296, -2.2183 + 1i*-0.562648, -2.23116 + 1i*-0.541756,  ...
-2.24366 + 1i*-0.520628, -2.2558 + 1i*-0.499272, -2.26757 + 1i*-0.477697, -2.27897 + 1i*-0.455911, -2.29 + 1i*-0.433922,  ...
-2.30065 + 1i*-0.41174, -2.31093 + 1i*-0.389372, -2.32081 + 1i*-0.366826, -2.33031 + 1i*-0.344113, -2.33941 + 1i*-0.321239,  ...
-2.34811 + 1i*-0.298213, -2.35642 + 1i*-0.275045, -2.36432 + 1i*-0.251742, -2.37181 + 1i*-0.228314, -2.3789 + 1i*-0.204769,  ...
-2.38557 + 1i*-0.181117, -2.39182 + 1i*-0.157364, -2.39766 + 1i*-0.133521, -2.40307 + 1i*-0.109596, -2.40805 + 1i*-0.0855987,  ...
-2.41261 + 1i*-0.0615377, -2.41673 + 1i*-0.037422, -2.42042 + 1i*-0.0132599, 0 + 1i*0, -2.42649 + 1i*0.0351652,  ...
-2.42886 + 1i*0.0594101, -2.43079 + 1i*0.083664, -2.43227 + 1i*0.107918, -2.4333 + 1i*0.132163, -2.43388 + 1i*0.15639,  ...
-2.43401 + 1i*0.180588, -2.43367 + 1i*0.204749, -2.43288 + 1i*0.228863, -2.43164 + 1i*0.25292, -2.42992 + 1i*0.276913,  ...
-2.42775 + 1i*0.300829, -2.42511 + 1i*0.324659, -2.422 + 1i*0.348394, -2.41842 + 1i*0.372025, -2.41437 + 1i*0.395541,  ...
-2.40985 + 1i*0.418931, -2.40485 + 1i*0.442186, -2.39938 + 1i*0.465297, -2.39343 + 1i*0.488252, -2.387 + 1i*0.511041,  ...
-2.3801 + 1i*0.533654, -2.37271 + 1i*0.556081, -2.36484 + 1i*0.578311, -2.35649 + 1i*0.600334, -2.34766 + 1i*0.622137,  ...
-2.33834 + 1i*0.643713, -2.32854 + 1i*0.665048, -2.31825 + 1i*0.686133, -2.30748 + 1i*0.706955, -2.29622 + 1i*0.727505,  ...
-2.28448 + 1i*0.74777, -2.27224 + 1i*0.76774, -2.25952 + 1i*0.787403, -2.24631 + 1i*0.806746, -2.23262 + 1i*0.825759,  ...
-2.21844 + 1i*0.844431, -2.20377 + 1i*0.862747, -2.18861 + 1i*0.880698, -2.17297 + 1i*0.898271, -2.15685 + 1i*0.915453,  ...
-2.14024 + 1i*0.932231, -2.12314 + 1i*0.948594, -2.10557 + 1i*0.964529, -2.08751 + 1i*0.980022, -2.06897 + 1i*0.995061,  ...
-2.04996 + 1i*1.00963, -2.03047 + 1i*1.02372, -2.0105 + 1i*1.03732, -1.99006 + 1i*1.05041, -1.96915 + 1i*1.06298,  ...
-1.94777 + 1i*1.07502, -1.92592 + 1i*1.0865, -1.90362 + 1i*1.09742, -1.88085 + 1i*1.10777, -1.85762 + 1i*1.11752,  ...
-1.83395 + 1i*1.12667, -1.80982 + 1i*1.13519, -1.78525 + 1i*1.14308, -1.76023 + 1i*1.15031, -1.73478 + 1i*1.15688,  ...
-1.7089 + 1i*1.16277, -1.68259 + 1i*1.16796, -1.65585 + 1i*1.17243, -1.6287 + 1i*1.17617, -1.60115 + 1i*1.17917,  ...
-1.57318 + 1i*1.1814, -1.54482 + 1i*1.18285, -1.51607 + 1i*1.18351, -1.48694 + 1i*1.18335, -1.45744 + 1i*1.18236,  ...
-1.42756 + 1i*1.18053, -1.39733 + 1i*1.17783, -1.36675 + 1i*1.17424, -1.33584 + 1i*1.16975, -1.30459 + 1i*1.16434,  ...
-1.27303 + 1i*1.15799, -1.24115 + 1i*1.15069, -1.20899 + 1i*1.14241, -1.17654 + 1i*1.13314, -1.14382 + 1i*1.12285,  ...
-1.11084 + 1i*1.11153, -1.07762 + 1i*1.09916, -1.04417 + 1i*1.08571, -1.01051 + 1i*1.07118, -0.976655 + 1i*1.05553,  ...
-0.942618 + 1i*1.03875, -0.908418 + 1i*1.02083, -0.874074 + 1i*1.00173, -0.839605 + 1i*0.981433, -0.80503 + 1i*0.959927,  ...
-0.770372 + 1i*0.937189, -0.73565 + 1i*0.913197, -0.700887 + 1i*0.887931, -0.666108 + 1i*0.86137, -0.631336 + 1i*0.833492,  ...
-0.596598 + 1i*0.804278, -0.561919 + 1i*0.773707, -0.527327 + 1i*0.741757, -0.49285 + 1i*0.708408, -0.458519 + 1i*0.67364,  ...
-0.424364 + 1i*0.637431, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0];
CH1_1228 = [ ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, -1.02211 + 1i*0.893197, -1.05911 + 1i*0.902004, -1.09585 + 1i*0.909973, -1.13231 + 1i*0.917142,  ...
-1.16848 + 1i*0.923544, -1.20434 + 1i*0.929213, -1.23986 + 1i*0.934181, -1.27505 + 1i*0.93848, -1.30988 + 1i*0.942141,  ...
-1.34435 + 1i*0.945192, -1.37844 + 1i*0.947663, -1.41215 + 1i*0.94958, -1.44547 + 1i*0.950971, -1.4784 + 1i*0.95186,  ...
-1.51093 + 1i*0.952273, -1.54306 + 1i*0.952232, -1.57479 + 1i*0.951758, -1.60611 + 1i*0.950875, -1.63702 + 1i*0.949602,  ...
-1.66752 + 1i*0.947959, -1.69762 + 1i*0.945963, -1.7273 + 1i*0.943632, -1.75659 + 1i*0.940984, -1.78546 + 1i*0.938033,  ...
-1.81394 + 1i*0.934795, -1.84201 + 1i*0.931283, -1.86969 + 1i*0.927511, -1.89697 + 1i*0.92349, -1.92387 + 1i*0.919232,  ...
-1.95038 + 1i*0.914748, -1.9765 + 1i*0.910049, -2.00224 + 1i*0.905144, -2.02762 + 1i*0.900039, -2.05262 + 1i*0.894747,  ...
-2.07725 + 1i*0.889271, -2.10152 + 1i*0.883619, -2.12544 + 1i*0.877797, -2.149 + 1i*0.871812, -2.17222 + 1i*0.865669,  ...
-2.19509 + 1i*0.85937, -2.21763 + 1i*0.852921, -2.23983 + 1i*0.846326, -2.2617 + 1i*0.839586, -2.28325 + 1i*0.832706,  ...
-2.30448 + 1i*0.825686, -2.32539 + 1i*0.81853, -2.34599 + 1i*0.811238, -2.36628 + 1i*0.803811, -2.38627 + 1i*0.796252,  ...
-2.40596 + 1i*0.788558, -2.42536 + 1i*0.78073, -2.44446 + 1i*0.77277, -2.46328 + 1i*0.764676, -2.48181 + 1i*0.756446,  ...
-2.50006 + 1i*0.748082, -2.51803 + 1i*0.73958, -2.53572 + 1i*0.730942, -2.55315 + 1i*0.722162, -2.5703 + 1i*0.713242,  ...
-2.58718 + 1i*0.704178, -2.6038 + 1i*0.694969, -2.62016 + 1i*0.685612, -2.63626 + 1i*0.676106, -2.6521 + 1i*0.666447,  ...
-2.66768 + 1i*0.656632, -2.683 + 1i*0.646662, -2.69807 + 1i*0.63653, -2.71288 + 1i*0.626237, -2.72744 + 1i*0.615778,  ...
-2.74175 + 1i*0.60515, -2.7558 + 1i*0.594352, -2.7696 + 1i*0.58338, -2.78315 + 1i*0.572229, -2.79645 + 1i*0.560901,  ...
-2.80949 + 1i*0.54939, -2.82228 + 1i*0.537694, -2.83481 + 1i*0.52581, -2.84709 + 1i*0.513737, -2.8591 + 1i*0.501469,  ...
-2.87086 + 1i*0.489007, -2.88236 + 1i*0.476348, -2.8936 + 1i*0.463488, -2.90457 + 1i*0.450427, -2.91527 + 1i*0.437161,  ...
-2.92571 + 1i*0.42369, -2.93587 + 1i*0.410011, -2.94575 + 1i*0.396122, -2.95535 + 1i*0.382023, -2.96468 + 1i*0.367713,  ...
-2.97371 + 1i*0.353189, -2.98245 + 1i*0.338451, -2.9909 + 1i*0.323499, -2.99905 + 1i*0.308332, -3.0069 + 1i*0.292949,  ...
-3.01444 + 1i*0.277351, -3.02166 + 1i*0.261539, -3.02857 + 1i*0.245513, -3.03515 + 1i*0.229272, -3.04141 + 1i*0.212819,  ...
-3.04733 + 1i*0.196155, -3.05291 + 1i*0.179281, -3.05814 + 1i*0.162199, 0 + 1i*0, -3.06755 + 1i*0.127422,  ...
-3.0717 + 1i*0.109731, -3.07549 + 1i*0.091845, -3.0789 + 1i*0.073764, -3.08192 + 1i*0.0554946, -3.08455 + 1i*0.0370392,  ...
-3.08678 + 1i*0.0184023, -3.08861 + 1i*-0.000408962, -3.09002 + 1i*-0.019391, -3.09101 + 1i*-0.0385391, -3.09158 + 1i*-0.0578435,  ...
-3.09171 + 1i*-0.0773013, -3.09139 + 1i*-0.0969041, -3.09063 + 1i*-0.116644, -3.08941 + 1i*-0.136514, -3.08772 + 1i*-0.156506,  ...
-3.08556 + 1i*-0.176612, -3.08292 + 1i*-0.196821, -3.07979 + 1i*-0.217126, -3.07617 + 1i*-0.237516, -3.07204 + 1i*-0.25798,  ...
-3.0674 + 1i*-0.278507, -3.06225 + 1i*-0.299087, -3.05656 + 1i*-0.319709, -3.05035 + 1i*-0.340359, -3.0436 + 1i*-0.361025,  ...
-3.03629 + 1i*-0.381696, -3.02844 + 1i*-0.402357, -3.02002 + 1i*-0.422993, -3.01104 + 1i*-0.443591, -3.00149 + 1i*-0.464137,  ...
-2.99135 + 1i*-0.484615, -2.98063 + 1i*-0.505008, -2.96932 + 1i*-0.525301, -2.95741 + 1i*-0.545481, -2.9449 + 1i*-0.565527,  ...
-2.93178 + 1i*-0.585421, -2.91804 + 1i*-0.605148, -2.90369 + 1i*-0.624691, -2.88872 + 1i*-0.644028, -2.87312 + 1i*-0.663143,  ...
-2.85689 + 1i*-0.682018, -2.84003 + 1i*-0.700629, -2.82253 + 1i*-0.718959, -2.80439 + 1i*-0.736987, -2.78561 + 1i*-0.754695,  ...
-2.76619 + 1i*-0.77206, -2.74612 + 1i*-0.78906, -2.7254 + 1i*-0.805676, -2.70404 + 1i*-0.821887, -2.68202 + 1i*-0.837669,  ...
-2.65936 + 1i*-0.853001, -2.63604 + 1i*-0.867861, -2.61208 + 1i*-0.882226, -2.58746 + 1i*-0.896075, -2.5622 + 1i*-0.909384,  ...
-2.5363 + 1i*-0.922131, -2.50974 + 1i*-0.934292, -2.48255 + 1i*-0.945846, -2.45471 + 1i*-0.95677, -2.42624 + 1i*-0.967039,  ...
-2.39714 + 1i*-0.976632, -2.3674 + 1i*-0.985525, -2.33703 + 1i*-0.993697, -2.30605 + 1i*-1.00112, -2.27444 + 1i*-1.00778,  ...
-2.24222 + 1i*-1.01365, -2.20939 + 1i*-1.0187, -2.17595 + 1i*-1.02292, -2.14192 + 1i*-1.02629, -2.10729 + 1i*-1.02877,  ...
-2.07207 + 1i*-1.03036, -2.03627 + 1i*-1.03102, -1.99989 + 1i*-1.03074, -1.96294 + 1i*-1.0295, -1.92542 + 1i*-1.02727,  ...
-1.88735 + 1i*-1.02404, -1.84871 + 1i*-1.01979, -1.80953 + 1i*-1.0145, -1.76981 + 1i*-1.00815, -1.72954 + 1i*-1.00073,  ...
-1.68875 + 1i*-0.992203, -1.64742 + 1i*-0.98257, -1.60557 + 1i*-0.971809, -1.56319 + 1i*-0.959905, -1.5203 + 1i*-0.946845,  ...
-1.4769 + 1i*-0.932611, -1.43298 + 1i*-0.917193, -1.38856 + 1i*-0.900577, -1.34362 + 1i*-0.882752, -1.29818 + 1i*-0.863705,  ...
-1.25223 + 1i*-0.843427, -1.20577 + 1i*-0.821909, -1.1588 + 1i*-0.799143, -1.11131 + 1i*-0.775121, -1.0633 + 1i*-0.749837,  ...
-1.01477 + 1i*-0.723285, -0.965716 + 1i*-0.695461, -0.916118 + 1i*-0.666363, -0.865973 + 1i*-0.635987, -0.815271 + 1i*-0.604334,  ...
-0.763999 + 1i*-0.571403, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0, 0 + 1i*0,  ...
0 + 1i*0];

M = length(CH0_1227); subcarrier_idx = (-floor(M/2)):(M-floor(M/2)-1);
figure; subplot(2,1,1); hold on; grid on;
plot(subcarrier_idx, abs(CH0_1227));legend_labels{1} = sprintf('CH %d', 0);
plot(subcarrier_idx, abs(CH1_1228));legend_labels{2} = sprintf('CH %d', 1);

title('Channel Frequency Response Gain');xlabel('Subcarrier index'); ylabel('Gain [V^2]');xlim([subcarrier_idx(1), subcarrier_idx(end)]);legend(legend_labels, 'Location', 'best');hold off;
subplot(2,1,2); hold on; grid on;
plot(subcarrier_idx, angle(CH0_1227));
plot(subcarrier_idx, angle(CH1_1228));

title('Channel Frequency Response Phase');xlabel('Subcarrier index'); ylabel('Phase [rad]');xlim([subcarrier_idx(1), subcarrier_idx(end)]);legend(legend_labels, 'Location', 'best');hold off;
figure; hold on; grid on; axis equal;
plot(real(CH0_1227), imag(CH0_1227), '.', 'MarkerSize', 10);
plot(real(CH1_1228), imag(CH1_1228), '.', 'MarkerSize', 10);

xlabel('Real'); ylabel('Imaginary');title('Channel Frequency Response');legend(legend_labels, 'Location', 'best');hold off;
