# 
## Realtime calculation and evaluation of channel state information for IEEE802.11n WLAN 

### Objective
Provision of synchronized CSI-datastreams, generated by several SDR-Receivers for processing of AoA/TDoA algorithms matched to received packets. 

### Roadmap DoA for LoRa-Signals
1) Realtime generation of CSI-Data for LoRa protocol with a single receiver
    1) Algorithm for calculating CSI from raw IQ-Data in Gnuradio / Matlab 
    2) Deployment on Raspberry-PI for decentralized CSI-calculation
2) CSI-Evaluation for multiple receivers
    1) Synchronization of SDRs and Raspberry-PI
    2) Datatransfer from multiple Raspberry-PIs to PC
    3) Dataformatting for pyespargos-compatibility 
    4) additionally: own AoA / TDoA implementation
3) Localization of RF-Emitter with TDoA/AoA
    1) Design of an antenna array

### Hardware
For establishing a WLAN-transmission with known transmission-properties, it is advisable, to use a board with an **ESP32** chip. The ESP32 is able to transmit wireless signals compliant to IEEE 802.11n (IEEE 802.11-2012), which is the reason, why the focus below is on this standard and not on the latest one. <br>
As described in [CSI-Calculation ](CSI-Calculation), the relevant signal is distributed to different carriers, that are spread over the channel-bandwidth (20MHz or 40MHz). The SDR has to provide a sample-rate of at least 20MSPS to sample all subcarriers, carrying the traing-field-signal of the 20MHz transmission. 
#### HackRF
Provides 2-20MS/s 
#### USRP N210 
Provides 100MS/s


### CSI-Calculation 
WLAN-transmissions use orthogonal frequency division multiplexing and divide the 20MHz channel into 64 subcarriers and the 40MHz channel into 128 subcarriers (IEEE Std 802.11-2012, chapter 2.3.7, S.1691). The original serial datastream is divided into parallel streams, each with a lower transmission-rate. A single Symbol of a parallelized stream is called OFDM-symbol. 
<br>

The IEEE 802.11n introduces the PLCP (physical layer convergence protocol), that adds a preamble and a PLCP-header to the PSDU (PLCP Service Data Unit). The composition of the whole PPDU (PLCP Protocol data unit) depends on the used transmision-mode (non-HT, mixed-HT and HT) (high-throughput) (IEEE Std 802.11-2012 Figure 20-1, S.1682).


IEEE802.11n defines training-fields (predefined complex OFDM-Symbols) as a part of the PPDU-preamble, that are transmitted on a subset of the respective subcarriers. The training-fields are used by the receiver for channel-estimation, time-synchronization, gain-control and carrier-offset. The OFDM-Symbols, transmitted by each subcarrier are defined in IEEE Std 802.11-2012 chapter 2.3.9.
<br>
Because the OFDM-Symbols are predefined by the standardization, the Spectrum of the sent signal $S(\omega)$ is known. The Channel-State-Information represents the transfer-function of the channel, that can be calculated by dividing the spectrum of the received training-field by the spectrum of the sent training-field: 
$$H(\omega)=\frac{R(\omega)}{S(\omega)}$$

The receivers have to be synchronized, because
$$\mathcal{F} \{ r(t-\tau) \}=\mathcal{F} \{ r(t) \}*e^{-j\omega \tau}$$
